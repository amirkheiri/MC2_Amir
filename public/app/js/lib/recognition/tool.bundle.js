!function e(t,n,o){function r(s,l){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!l&&a)return a(s,!0);if(i)return i(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return r(n||e)},c,c.exports,e,t,n,o)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<o.length;s++)r(o[s]);return r}({1:[function(e,t,n){"use strict";var o=e("./Symbol"),r=e("./enums/SymbolTypes"),i=function(e){function t(e,n,o,i,s){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o,i,s,r.ALPHANUMERIC))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o),t}();t.exports=i},{"./Symbol":9,"./enums/SymbolTypes":13}],2:[function(e,t,n){"use strict";var o=e("./Symbol"),r=e("./enums/SymbolTypes"),i=e("./enums/BracketTypes"),s=function(e){function t(e,n,o,s,l){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var a=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o,s,l,r.BRACKET));a.bracketType=i.CLOSE;var u=["lbracket","(",")","rbracket"];return u.indexOf(l)<u.length/2&&(a.minX-=o,a.maxX-=o,a.x-=o,a.bracketType=i.OPEN),a}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o),t}();t.exports=s},{"./Symbol":9,"./enums/BracketTypes":11,"./enums/SymbolTypes":13}],3:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();e("./Symbol"),e("./enums/SymbolTypes");var r=e("./enums/RegionTypes"),i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.ROOT;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.region_type=t,this.region_name=t,this.wall={left:0,bottom:1/0,right:1/0,top:0},this.symbols=[]}return o(e,[{key:"addSymbol",value:function(e){this.symbols.push(e)}},{key:"setWall",value:function(e,t,n,o){if(!e.left)return e.length&&3==e.length?(this.wall.left=e[0][0],this.wall.bottom=e[0][1],this.wall.right=e[1][0],void(this.wall.top=e[1][1])):void(this.wall={left:e,bottom:o,right:n,top:t});this.wall=e}},{key:"hasElement",value:function(){return this.symbols.length>0}},{key:"apply",value:function(e,t,n){n||(n=function(){return!0}),t||(t=function(){return!0});for(var o=0;o<this.symbols.length;o++)if("lim"===this.symbols[o].value){for(var r=!1,i=0;i<this.symbols[o].subSymbols.length;i++)n(this.symbols[o].subSymbols[i])?(e(this.symbols[o].subSymbols[i]),this.symbols[o].subSymbols[i].apply(e,function(e){return!0},n),r=!0):this.symbols[o].subSymbols[i].apply(e,t,n);r?this.symbols[o].apply(e,function(e){return!0},n):this.symbols[o].apply(e,t,n)}else n(this.symbols[o])?(e(this.symbols[o]),this.symbols[o].apply(e,function(e){return!0},n)):this.symbols[o].apply(e,t,n)}}]),e}();t.exports=i},{"./Symbol":9,"./enums/RegionTypes":12,"./enums/SymbolTypes":13}],4:[function(e,t,n){"use strict";var o=e("./Symbol"),r=e("./enums/SymbolTypes"),i=function(e){function t(e,n,o,i,s){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o,i,s,r.FRACTION))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o),t}();t.exports=i},{"./Symbol":9,"./enums/SymbolTypes":13}],5:[function(e,t,n){"use strict";var o=e("./Symbol"),r=e("./enums/SymbolTypes"),i=function(e){function t(e,n,o,i,s){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o,i,s,r.LIMIT))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o),t}();t.exports=i},{"./Symbol":9,"./enums/SymbolTypes":13}],6:[function(e,t,n){"use strict";var o=e("./Symbol"),r=e("./enums/SymbolTypes"),i=function(e){function t(e,n,o,i,s){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o,i,s,r.OPERATOR))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o),t}();t.exports=i},{"./Symbol":9,"./enums/SymbolTypes":13}],7:[function(e,t,n){"use strict";var o=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],o=!0,r=!1,i=void 0;try{for(var s,l=e[Symbol.iterator]();!(o=(s=l.next()).done)&&(n.push(s.value),!t||n.length!==t);o=!0);}catch(e){r=!0,i=e}finally{try{!o&&l.return&&l.return()}finally{if(r)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),r=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i=e("./enums/SymbolTypes"),s=e("./SymbolFactory"),l=e("./enums/BracketTypes"),a=e("./Expression"),u=(e("./Symbol"),function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return r(e,[{key:"hor",value:function(e,t){if(e[t].type===i.FRACTION||e[t].type===i.BRAKET&&e[t].bracketType==l.OPEN||e[t].type===i.OPERATOR){var n=e[t].getWallCopy();n.left=e[t].maxX;var o=this.start(e,n);return-1==o?-1:this.overlap(o,e[t].wall,e)}for(var r=0;r<e.length;){if(this.isInRegion(e[t].wall,e[r])&&!e[r].marked&&e[t].maxX<=e[r].minX&&e[t].minY+.4*e[t].height<=e[r].y&&e[r].y<e[t].maxY-1*e[t].height/5)return this.overlap(r,e[t].wall,e);r++}return-1}},{key:"start",value:function(e,t){for(var n=-1,o=-1,r=0,i=-1,s=e.length;-1==n&&r<s;)!e[r].marked&&this.isInRegion(t,e[r])?n=r:r+=1;if(-1==n||o==n)return n;for(;r<s&&-1==o;)!e[r].marked&&"limit"===e[r].type&&this.isInRegion(t,e[r])?o=r:r+=1;if(-1==o||o==n)return this.overlap(n,t,e);for(var l=e[o].maxY,a=e[o].minY;r>n;)e[r-=1].y<l&&e[r].y>=a&&(i=r);return i<o&&-1!=i?this.overlap(n,t,e):this.overlap(o,t,e)}},{key:"overlap",value:function(e,t,n){var o,r=e,i=t.top,s=t.bottom,l=!1,a=n.length;o=(n[e].type,n[e].width);for(var u=-1;r>0&&!l;)n[r-1].maxX<n[e].minX?l=!0:r-=1;for(;r<a&&n[r].minX<n[e].maxX;)!n[r].marked&&"fraction"===n[r].type&&n[r].y>i&&n[r].y<=s&&n[r].minX<=n[e].x&&n[r].width>o?(o=n[r].width,u=r):r++;return-1==u?e:u}},{key:"isInRegion",value:function(e,t){return e.left<=t.x&&t.x<e.right&&e.top<=t.y&&t.y<=e.bottom}}],[{key:"getSymbolType",value:function(e){return-1!=BRACKET.indexOf(e)?i.BRACKET:-1!=LINE.indexOf(e)?i.FRACTION:-1!=ROOT.indexOf(e)?i.ROOT:-1!=LIMIT.indexOf(e)?i.LIMIT:-1!=OPERATOR.indexOf(e)?i.OPERATOR:i.ALPHANUMERIC}},{key:"parse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(!e){e=[];var t=svgCanvas.getSelectedElems().slice(0);0==t.__proto__.length&&(t=document.querySelectorAll('[id^="svg_eqn_"]'));for(var n=0;n<t.length;n++){var r=s.make(t[n]);r&&e.push(r)}}e.sort(function(e,t){var n=e.minX-t.minX;return 0==n?e.minY-t.minY:n});var i,l,u,c,f,y=new a,p=[],h=[],b=y.wall,m=start(e,b);for(-1!=m&&(e[m].setWall(b),h.push([m,y]),e[m].marked=!0);0!=h.length;)for(;0!=h.length;){var g=h.shift(),T=o(g,2);for(i=T[0],u=T[1],(c=e[i]).marked=!0,u.symbols.push(c),p.push([i,c]),b=e[i].wall,l=this.hor(e,i);-1!=l;){var v=e[i].wall;e[l].setWall(v),c=e[l];var w=u.symbols.length;if("m"===c.value&&w>=2&&"i"===u.symbols[w-1].value&&"l"===u.symbols[w-2].value){var O=u.symbols[w-1],E=u.symbols[w-2],x=E.minX,S=E.minY,_=c.x+c.width-x,d=E.height,R=new LimitSymbol(x,S,_,d,"lim");R.setWall(v),R.subSymbols=[E,O,c],c=R,e[l]=c,p.splice(p.indexOf([e.indexOf(E),E]),1),p.splice(p.indexOf([e.indexOf(O),O]),1),u.symbols.pop(),u.symbols.pop()}u.symbols.push(c),p.push([l,c]),e[i].wall.right=e[l].minX,"limit"!==e[l].type||"bracket"!==e[i].type&&"line"!==e[i].type||(e[l].wall.left=e[i].maxX),e[i=l].marked=!0,l=this.hor(e,i)}for(p.push("EOBL");0!=p.length;){"EOBL"===p[p.length-1]&&p.pop();var k=p.pop(),A=o(k,2);i=A[0];var C=(c=A[1]).wall.top,P=c.wall.bottom,X=u.symbols.indexOf(c),j=X==u.symbols.length-1?c.wall.right:u.symbols[X+1].minX,I=c.minX;c.type===SYMBOL_TYPES.LIMIT&&(0==X?I=b.left:u.symbols[X-1].type===SYMBOL_TYPES.BRACKET?I=u.symbols[X-1].maxX:u.symbols[X-1].type===SYMBOL_TYPES.FRACTION&&(I=u.symbols[X-1].maxX));for(var B=c.minX,L=c.maxX,N=c.minY,Y=c.maxY,M=N+.4*(Y-N),F=Y-.4*(Y-N),W=[[[B,N],[L,C],"above"],[[B,P],[L,Y],"below"],[[L,M],[j,C],"supers"],[[L,P],[j,F],"subsc"],[[I,M],[B,C],"tleft"],[[I,P],[B,F],"bleft"],[[B,Y],[L,N],"contains"]],K=0;K<W.length;K++)c.region[W[K][2]]&&(c.region[W[K][2]].setWall(W[K]),-1!=(l=this.start(e,c.region[W[K][2]].wall))&&(e[l].marked=!0,e[l].setWall(c.region[W[K][2]].wall),f=c.region[W[K][2]],h.push([l,f])))}}return y}},{key:"getTex",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.parse(),n="";if(t.symbols){"root"==t.region_name&&(n+="$$");for(var o=0;o<t.symbols.length;o++){n+=e.getTex(t.symbols[o])}return n.indexOf("lim")>=0&&(n=n.replace("li "," ")),"root"==t.region_name&&(n=(n+="$$").replace(/arcsin|arccos|arctan|cosh|sinh|tanh|cos|sin|tan/gi,function(e){return" \\"+e+" "})),n}var r=t.value,i=t,s=t.type;return"limit"===s?(n+=TEX_TEXT[r]+" ",t.hasAnyBottom()&&(n+="_{"+e.getTex(t.region.bleft)+e.getTex(t.region.below)+e.getTex(t.region.subsc)+"} "),t.hasAnyTop()&&(n+="^{"+e.getTex(t.region.tleft)+e.getTex(t.region.above)+e.getTex(t.region.supers)+"} ")):"fraction"===s?t.hasAnyTop()&&t.hasAnyBottom()?(n+=TEX_TEXT.fraction,n+="{",n+=e.getTex(t.region.tleft)+e.getTex(t.region.above)+e.getTex(t.region.supers),n+="}{",n+=e.getTex(t.region.bleft)+e.getTex(t.region.below)+e.getTex(t.region.subsc),n+="} "):t.hasAnyBottom()?(n+=TEX_TEXT.overline,n+="{"+e.getTex(t.region.bleft)+e.getTex(t.region.below)+e.getTex(t.region.subsc)+"}"):t.hasAnyTop()?(n+=TEX_TEXT.underline,n+="{"+e.getTex(t.region.tleft)+e.getTex(t.region.above)+e.getTex(t.region.supers)+"}"):n+=" - ":"root"===s?(n+=TEX_TEXT[r]+"{"+e.getTex(t.region.contains)+"} ",t.region.supers.hasElement()&&(n+="^{"+e.getTex(t.region.supers)+"} "),t.region.subsc.hasElement()&&(n+="_{"+e.getTex(t.region.subsc)+"} ")):"bracket"===s?(n+=TEX_TEXT[r],i.bracketType==BRACKET_TYPES.CLOSE&&(t.region.supers.hasElement()&&(n+="^{"+e.getTex(t.region.supers)+"}"),t.region.subsc.hasElement()&&(n+="_{"+e.getTex(t.region.subsc)+"} "))):"operator"==s?n+=TEX_TEXT[r]:(n+=r,t.region.supers.hasElement()&&(n+="^{"+e.getTex(t.region.supers)+"}"),t.region.subsc.hasElement()&&(n+="_{"+e.getTex(t.region.subsc)+"}")),n}}]),e}());t.exports=u},{"./Expression":3,"./Symbol":9,"./SymbolFactory":10,"./enums/BracketTypes":11,"./enums/SymbolTypes":13}],8:[function(e,t,n){"use strict";var o=e("./Symbol"),r=e("./enums/SymbolTypes"),i=function(e){function t(e,n,o,i,s){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,o,i,s,r.ROOT))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o),t}();t.exports=i},{"./Symbol":9,"./enums/SymbolTypes":13}],9:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();e("./enums/SymbolTypes");var r=e("./enums/RegionTypes"),i=function(){function e(t,n,o,i,s,l){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.constructor===e)throw new Error("Abstract Class Instatiation Error");this.type=l,this.minX=t,this.minY=n,this.maxX=t+o,this.maxY=n+i,this.value=s,this.width=o,this.height=i,this.x=(this.minX+this.maxX)/2,this.y=(this.minY+this.maxY)/2,this.region={};for(var a in r)this.region[r[a]]=new Expression(r[a]);this.wall={},this.size=o*i}return o(e,[{key:"hasAnyTop",value:function(){return this.region.tleft.hasElement()||this.region.above.hasElement()||this.region.supers.hasElement()}},{key:"hasAnyBottom",value:function(){return this.region.bleft.hasElement()||this.region.below.hasElement()||this.region.subsc.hasElement()}},{key:"setWall",value:function(e){this.wall.top=e.top,this.wall.bottom=e.bottom,this.wall.left=e.left,this.wall.right=e.right}},{key:"getWallCopy",value:function(){return{top:this.wall.top,bottom:this.wall.bottom,left:this.wall.left,right:this.wall.right}}},{key:"apply",value:function(e,t,n){for(var o in this.region)if(this.region[o].hasElement()){var r=t(this.region[o]);this.region[o].apply(e,t,function(e){return r&&n(e)})}}}]),e}();t.exports=i},{"./enums/RegionTypes":12,"./enums/SymbolTypes":13}],10:[function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();e("./Symbol");var r=e("./AlphanumericSymbol"),i=e("./BracketSymbol"),s=e("./FractionSymbol"),l=e("./LimitSymbol"),a=e("./OperatorSymbol"),u=e("./RootSymbol"),c=e("./RecognitionTool"),f=e("./enums/SymbolTypes"),y=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,null,[{key:"make",value:function(e){if(" "==e.textContent||"g"==e.tagName)return null;var t,n=svgedit.utilities.getBBox(e),o=n.x,y=n.y,p=n.width,h=n.height,b="path"==e.nodeName?e.id.split("_")[3]:e.textContent;switch(c.getSymbolType(b)){case f.BRACKET:t=new i(o,y,p,h,b);break;case f.FRACTION:sybmol=new s(o,y,p,h,b);break;case f.ROOT:t=new u(o,y,p,h,b);break;case f.LIMIT:t=new l(o,y,p,h,b);break;case f.ALPHANUMERIC:t=new r(o,y,p,h,b);break;case f.OPERATOR:t=new a(o,y,p,h,b);break;default:throw"Cannot have any other symbol than type."}return t}}]),e}();t.exports=y},{"./AlphanumericSymbol":1,"./BracketSymbol":2,"./FractionSymbol":4,"./LimitSymbol":5,"./OperatorSymbol":6,"./RecognitionTool":7,"./RootSymbol":8,"./Symbol":9,"./enums/SymbolTypes":13}],11:[function(e,t,n){"use strict";t.exports={OPEN:0,CLOSE:1}},{}],12:[function(e,t,n){"use strict";t.exports={ROOT:0,TLEFT:1,ABOVE:2,SUPER:3,CONTAINS:4,BLEFT:5,BELOW:6,SUBSC:7}},{}],13:[function(e,t,n){"use strict";t.exports={ALPHANUMERIC:0,BRACKET:1,FRACTION:2,LIMIT:3,OPERATOR:4,ROOT:5}},{}],14:[function(e,t,n){"use strict";window.Tool={RecognitionTool:e("./RecognitionTool")}},{"./RecognitionTool":7}]},{},[14]);